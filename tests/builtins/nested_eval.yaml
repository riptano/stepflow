schema: https://stepflow.org/schemas/v1/flow.json
name: nested_eval_test
description: Test nested flow execution with eval component
steps:
- id: create_nested_flow
  component: /builtin/put_blob
  input:
    data:
      $literal:
        schema: https://stepflow.org/schemas/v1/flow.json
        name: simple_nested
        steps:
        - id: inner_step
          component: /builtin/create_messages
          input:
            user_prompt: Hello from nested flow
        output:
          result:
            $from:
              step: inner_step
    blob_type: "flow"

- id: nested_flow
  component: /builtin/eval
  inputSchema: null
  outputSchema: null
  input:
    flow_id: { $from: { step: create_nested_flow }, path: "blob_id" }
    input: {}
output:
  nested_result:
    $from:
      step: nested_flow
    path: $.result
test:
  cases:
  - name: test nested flow execution
    input: {}
    output:
      outcome: success
      result:
        nested_result:
          outcome: success
          result:
            result:
              messages:
              - content: Hello from nested flow
                role: user
